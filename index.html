<!DOCTYPE html>
<html>
<head>
    <title>GitHub æ–‡ä»¶ç®¡ç†å™¨</title>
    <style>
        body { font-family: Arial; max-width: 800px; margin: 0 auto; padding: 20px; }
        .container { background: #f5f5f5; padding: 20px; border-radius: 8px; }
        .input-group { margin: 10px 0; }
        input, textarea, button { width: 100%; padding: 8px; margin: 5px 0; }
        button { background: #0366d6; color: white; border: none; cursor: pointer; }
        button:hover { background: #0256b9; }
        .log { background: #333; color: #0f0; padding: 10px; margin: 10px 0; font-family: monospace; }
    </style>
</head>
<body>
    <div class="container">
        <h1>GitHub Pages æ–‡ä»¶ç®¡ç†å™¨</h1>
        
        <div class="input-group">
            <input type="text" id="filePath" placeholder="æ–‡ä»¶è·¯å¾„ï¼Œå¦‚: data/config.json">
        </div>
        
        <div class="input-group">
            <textarea id="fileContent" placeholder="æ–‡ä»¶å†…å®¹" rows="10"></textarea>
        </div>
        
        <div class="input-group">
            <input type="text" id="commitMessage" placeholder="æäº¤ä¿¡æ¯" value="æ›´æ–°æ–‡ä»¶">
        </div>
        
        <button onclick="readFile()">è¯»å–æ–‡ä»¶</button>
        <button onclick="writeFile()">å†™å…¥æ–‡ä»¶</button>
        <button onclick="deleteFile()">åˆ é™¤æ–‡ä»¶</button>
        <button onclick="listFiles()">åˆ—å‡ºæ–‡ä»¶</button>
        
        <div id="log" class="log"></div>
    </div>

    <script>
        // è¿™é‡Œåº”è¯¥ä»å®‰å…¨çš„åœ°æ–¹è·å– token
        const fileManager = new GitHubFileManager(
            'ä½ çš„ç”¨æˆ·å',
            'ä½ çš„ç”¨æˆ·å.github.io',
            'ä½ çš„token'
        );

        function log(message) {
            const logElement = document.getElementById('log');
            logElement.innerHTML = message + '\n' + logElement.innerHTML;
        }

        async function readFile() {
            const filePath = document.getElementById('filePath').value;
            if (!filePath) {
                log('âŒ è¯·è¾“å…¥æ–‡ä»¶è·¯å¾„');
                return;
            }
            
            try {
                log('ğŸ“– æ­£åœ¨è¯»å–æ–‡ä»¶...');
                const file = await fileManager.getFile(filePath);
                document.getElementById('fileContent').value = file.content;
                log('âœ… æ–‡ä»¶è¯»å–æˆåŠŸ');
            } catch (error) {
                log(`âŒ è¯»å–å¤±è´¥: ${error.message}`);
            }
        }

        async function writeFile() {
            const filePath = document.getElementById('filePath').value;
            const content = document.getElementById('fileContent').value;
            const message = document.getElementById('commitMessage').value;
            
            if (!filePath || !content) {
                log('âŒ æ–‡ä»¶è·¯å¾„å’Œå†…å®¹ä¸èƒ½ä¸ºç©º');
                return;
            }
            
            try {
                log('ğŸ’¾ æ­£åœ¨å†™å…¥æ–‡ä»¶...');
                await fileManager.createOrUpdateFile(filePath, content, message);
                log('âœ… æ–‡ä»¶å†™å…¥æˆåŠŸ');
            } catch (error) {
                log(`âŒ å†™å…¥å¤±è´¥: ${error.message}`);
            }
        }

        async function deleteFile() {
            const filePath = document.getElementById('filePath').value;
            const message = document.getElementById('commitMessage').value;
            
            if (!filePath) {
                log('âŒ è¯·è¾“å…¥æ–‡ä»¶è·¯å¾„');
                return;
            }
            
            if (!confirm(`ç¡®å®šè¦åˆ é™¤ ${filePath} å—ï¼Ÿ`)) return;
            
            try {
                log('ğŸ—‘ï¸ æ­£åœ¨åˆ é™¤æ–‡ä»¶...');
                await fileManager.deleteFile(filePath, message);
                log('âœ… æ–‡ä»¶åˆ é™¤æˆåŠŸ');
                document.getElementById('filePath').value = '';
                document.getElementById('fileContent').value = '';
            } catch (error) {
                log(`âŒ åˆ é™¤å¤±è´¥: ${error.message}`);
            }
        }

        async function listFiles() {
            try {
                log('ğŸ“ æ­£åœ¨åˆ—å‡ºæ–‡ä»¶...');
                const files = await fileManager.listDirectory();
                let fileList = 'ä»“åº“æ ¹ç›®å½•æ–‡ä»¶:\n';
                files.forEach(file => {
                    fileList += `${file.type === 'dir' ? 'ğŸ“' : 'ğŸ“„'} ${file.path}\n`;
                });
                log(fileList);
            } catch (error) {
                log(`âŒ åˆ—å‡ºæ–‡ä»¶å¤±è´¥: ${error.message}`);
            }
        }
    </script>
</body>
</html>
